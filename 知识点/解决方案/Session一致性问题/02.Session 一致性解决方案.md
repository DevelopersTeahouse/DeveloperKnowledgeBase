# Session 一致性解决方案

## Nginx 的 IP_Hash 策略

- 同一个客户端会被路由到同一个目标服务器，也叫做会话粘滞

### 优点

- 配置简单，不入侵应用，不需要额外修改代码

### 缺点

- 服务器重启 Session 丢失
- 存在单点负载高的风险
- 单点故障问题

## Session 复制

- 多个 Tomcat 之间通过修改配置文件，达到 Session 之间的复制

### 优点

- 不入侵应用
- 便于服务器水平扩展
- 能适应各种负载均衡策略
- 服务器重启或者宕机不会造成 Session 丢失

## 缺点

- 性能低
- 内存消耗
- 不能存储太多数据，否则数据越多越影响性能
- 延迟性

## Session 集中存储

- Session 的本质就是缓存，所以我们可以将 Session 的数据存储到 Redis 中

## 优点

- 能适应各种负载均衡策略
- 服务器重启或者宕机不会造成 Session 丢失
- 扩展能力强
- 适合大集群使用

## 缺点

- 对代码有入侵，引入了和 Redis 交互的代码
